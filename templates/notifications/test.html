{% extends "base.html" %}

{% block title %}Test de notifications - CedricIA{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Tester les notifications</h1>
    <a href="{{ url_for('notifications.settings') }}" class="btn btn-secondary">← Retour aux paramètres</a>
</div>

<div class="test-container">
    <div class="test-card">
        <h2>Envoyer un message de test</h2>

        <form method="POST" class="form-standard">
            <div class="form-group">
                <label for="phone">Numéro de téléphone *</label>
                <input type="tel" id="phone" name="phone" required
                       placeholder="+33612345678 ou 0612345678">
                <small>Format international recommandé : +33...</small>
            </div>

            <div class="form-group">
                <label for="method">Méthode d'envoi *</label>
                <select id="method" name="method" required>
                    <option value="sms">SMS</option>
                    <option value="whatsapp">WhatsApp</option>
                </select>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Envoyer le test</button>
            </div>
        </form>
    </div>

    <div class="info-card">
        <h3>Informations importantes</h3>

        <h4>Pour tester les SMS :</h4>
        <ul>
            <li>Le numéro doit être vérifié dans votre compte Twilio (mode test)</li>
            <li>Utilisez le format international (+33...)</li>
            <li>Le SMS sera facturé selon votre plan Twilio</li>
        </ul>

        <h4>Pour tester WhatsApp :</h4>
        <ul>
            <li>Vous devez d'abord rejoindre le sandbox WhatsApp de Twilio</li>
            <li>Envoyez "join [votre-code-sandbox]" au numéro WhatsApp de Twilio</li>
            <li>Le numéro doit inclure le code pays (+33 pour la France)</li>
        </ul>

        <div class="alert alert-info">
            <strong>Configuration Twilio Sandbox WhatsApp :</strong><br>
            1. Connectez-vous à <a href="https://console.twilio.com/us1/develop/sms/try-it-out/whatsapp-learn" target="_blank">Twilio Console</a><br>
            2. Suivez les instructions pour rejoindre le sandbox<br>
            3. Envoyez le code de connexion depuis WhatsApp<br>
            4. Vous pouvez maintenant recevoir des messages de test
        </div>
    </div>
</div>

<style>
.test-container {
    max-width: 800px;
}

.test-card, .info-card {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-bottom: 2rem;
}

.info-card h4 {
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
    color: #2c3e50;
}

.info-card h4:first-of-type {
    margin-top: 0;
}

.info-card ul {
    margin-left: 1.5rem;
    margin-bottom: 1rem;
}

.info-card li {
    margin-bottom: 0.5rem;
}

.alert-info {
    background-color: #d1ecf1;
    border: 1px solid #bee5eb;
    color: #0c5460;
    padding: 1rem;
    border-radius: 4px;
    margin-top: 1.5rem;
}

.alert-info a {
    color: #0c5460;
    text-decoration: underline;
}
</style>
{% endblock %}
